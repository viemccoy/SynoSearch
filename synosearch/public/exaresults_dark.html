<!DOCTYPE html>
<html>
<head>
    <title>OpenAlex Search Results</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="description" content="Search smarter, not harder.">
    <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16">
    <style>
        body {
            background-color: #000000; /* Dark background for the body */
            color: #ffffff; /* Light text color */
        }
        #openAlexSearchResults div {
            border: 1px solid #888888; /* Lighter border color */
            margin: 10px;
            padding: 5px;
            font-size: 21px;
        }
        #openAlexSearchResults a {
            color: #ffffff; /* Light blue color for links */
            text-decoration: none;
        }
        #openAlexSearchResults .title {
            font-size: 18px;
        }
        #openAlexSearchResults .info {
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="openAlexSearchResults">
        <!-- Search results from OpenAlex API will be inserted here -->
    </div>
    <button id="prevPage">Previous</button>
    <button id="nextPage">Next</button>
    <script>
        var currentPage = 1;
        var query = new URLSearchParams(window.location.search).get('q');
    
        function fetchResults(page) {
            // Prepare the request body
            var requestBody = {
                useAutoprompt: false,
                numResults: 10,
                query: query, // Assuming you want to pass the query to the API
                page: page // Assuming the API supports pagination in this manner
            };
    
            // Make the POST request to the Exa AI API
            fetch('https://api.exa.ai/search', {
                method: 'POST',
                headers: {
                    'accept': 'application/json',
                    'content-type': 'application/json',
                    'x-api-key': `${process.env.EXA_API_KEY}` // Use the actual API key here
                },
                body: JSON.stringify(requestBody)
            })
            .then(response => response.json())
            .then(data => {
                var resultsDiv = document.getElementById('openAlexSearchResults');
                resultsDiv.innerHTML = '';
                // Assuming the response structure is similar; adjust according to the actual response
                data.results.forEach(result => {
                    var resultDiv = document.createElement('div');
                    resultDiv.innerHTML = `
                        <h2 class="title"><a href="${result.doi}" target="_blank">${result.display_name}</a></h2>
                        <p class="info">Keywords: ${result.keywords.map(keyword => keyword.keyword).join(', ')}</p>
                        <p class="info">Cited by: ${result.cited_by_count}</p>
                        <p class="info">Publication Date: ${new Date(result.publication_date).toLocaleDateString()}</p>
                    `;
                    resultsDiv.appendChild(resultDiv);
                });
            });
        }
    
        document.getElementById('prevPage').addEventListener('click', function() {
            if (currentPage > 1) {
                currentPage--;
                fetchResults(currentPage);
            }
        });
    
        document.getElementById('nextPage').addEventListener('click', function() {
            currentPage++;
            fetchResults(currentPage);
        });
    
        fetchResults(currentPage);
    </script>
</body>
</html>